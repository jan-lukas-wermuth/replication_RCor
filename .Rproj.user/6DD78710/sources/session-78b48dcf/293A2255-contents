---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# R package RCor

<!-- badges: start -->
<!-- badges: end -->

## Overview

This package accompanies the paper "Statistical Inference for Rank Correlations" by Marc-Oliver Pohle, Jan-Lukas Wermuth and Christian H. Wei√ü. 

It provides a comprehensive alternative to the `cor.test()` function from the `stats` package and only consists of one function: `RCor()`. This function returns an estimate as well as asymptotically valid confidence intervals for Pearson's $r$, Kendall's $\tau$, Kendall's $\tau_b$, Goodman-Kruskal's $\gamma$, Spearman's $\rho$ and Spearman's $\rho_b$. Additionally, p-values for the related independence (uncorrelatedness) tests are provided based on the asymptotic variance under independence and based on the asymptotic variance without independence assumption. All the inferential results are valid under iid or under classical time series assumptions and do not hinge on any normality or continuity assumptions. 

## Installation

You can install the development version of RCor from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
library(devtools)
devtools::install_github("jan-lukas-wermuth/RCor")
library(RCor)
```

## Examples

The first example simulates a bivariate sample with one nominal and one continuous marginal distribution that are independent if and only if `rho = 0`.

```{r example1, warning=FALSE, cache=FALSE}
library(NCor)
library(RCor)

# Define parameters
n <- 100 # sample size
rho <- 1 # dependence parameter

# Generate nominal covariate and create continuous dependent variable via regression
set.seed(1) 
X <- sample(c("A", "B", "C"), n, prob = c(1/3, 1/3, 1/3), replace = TRUE)
C_ind <- ifelse(X == "C", 1, 0)
B_ind <- ifelse(X == "B", 1, 0)
Y <- rho * B_ind - rho * C_ind + rnorm(n)

# Compute coefficient together with an estimated 90% confidence interval and the p-value for the related independence test
NCor::NCor(X, Y, nominal = "r", CIs = TRUE, Test = TRUE)[[1]]
```

A second example simulates from a $3\times 3$ probability contingency table that has one skewed and one uniform marginal distribution which are also independent if and only if `rho = 0`.

```{r example2, warning=FALSE, cache=FALSE}
library(NCor)
library(RCor)

# Define a 3x3 probability contingency table with dependence
rho <- 0.01 # dependence parameter
probabilities <- matrix(c(76/300 + 2*rho, 76/300 + 2*rho, 76/300 - 4*rho, 4/100 - rho, 4/100 - rho, 4/100 + 2*rho, 4/100 - rho, 4/100 - rho, 4/100 + 2*rho), nrow = 3)
prob_vector <- as.vector(probabilities)

# Simulate data from the probability contingency table
n <- 100
set.seed(1)
sampled_indices <- sample(1:9, size = n, replace = TRUE, prob = prob_vector)
contingency_table <- table(factor(sampled_indices, levels = 1:9))
contingency_matrix <- matrix(contingency_table, nrow = 3)

# Compute coefficient together with an estimated 90% confidence interval and the p-value for the related independence test
NCor::NCor(contingency_matrix, nominal = "rc", CIs = TRUE, Test = TRUE)[[1]]
```

